{% extends 'base.html' %}
{% load i18n %}

{% block content %}

<style>
  .row > * {
    padding-left: 0;
  }
</style>

{% if not user.username == poem.saved_by %}
<div class="container-fluid" style="margin-left: 0px; background-color: aliceblue; text-align: center; padding-bottom: 10px; padding-left: 30px;">
  <h class="display-6">{% trans 'You are not authorized to edit this poem.' %}</h>
</div>
{% else %}
<div class="container-fluid" style="margin-left: 0px; background-color: aliceblue; padding-bottom: 10px; padding-left: 30px;">

  <!-- Form to delete the poem -->
  <div class="row">
    <form id="delete-form" action="{% url 'poem_delete' poem.id %}" method="post" style="margin-top: 10px">
      {% csrf_token %}
      <button onclick="return confirm('Are you sure you want to delete this poem?')" {% if not user.username == poem.saved_by %}disabled{% endif %}
        class="btn btn-outline-danger" style="width: 200px;">{% trans "Delete" %}</button>
    </form>
  </div>

  <form action="{% url 'poem_update' poem.id %}" method="post">
    {% csrf_token %}

    <!-- Updated at -->
    <div class="row" style="margin-top: 15px;">
      <div class="input-group mb-3">
        <div class="input-group-prepend">
          <span class="input-group-text" id="inputGroup-sizing-default">{% trans "Updated at" %}</span>
        </div>
          {{ form.updated_at }}
      </div>
    </div>

    <div class="row" style="max-width: fit-content;">
      
      <!-- Language engine -->
      <div class="col">
        {{ form.language_engine }}
      </div>

      <!-- Is hidden from library -->
      <div class="col form-check form-switch" style="margin-left: 45px; display: flex; align-items: center;">
        {{ form.is_hidden }}
        <label class="form-check-label" for="flexSwitchCheckDefault">{% trans "Hide from Poem Library" %}</label>
      </div>

    </div>

    <div class="row" style="max-width: fit-content; margin-top: 10px;">

      <!-- Source language -->
      <div class="col">{{ form.source_lang }}</div>

      <!-- A simple right arrow -> -->
      <div class="col-1 my-auto"><svg style="margin-left: 10px; margin-right: 10px;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z" /></svg></div>

      <!-- Target language -->
      <div class="col">{{ form.target_lang }}</div>

      <!-- Save button -->
      <div class="col">
        <button class="btn btn-success" type="submit" style="width: 200px" {% if not user.username == poem.saved_by %}disabled{% endif %}>
          {% trans "Save Changes" %}
        </button>
      </div>
    </div>
    
    <div class="row">
    {% if form.source_lang.errors %}
      {% for error in form.source_lang.errors %}
      <p class="text-danger">{{ error }}</p>
      {% endfor %}
      {% endif %}
    </div>

    <div class="row" style="margin-top: 20px">

      <!-- Title -->
      <div class="col-lg-2 col-md-3 col-sm-6">
        <h class="display-6" for="title">{% trans "Title" %}</h>
        {{ form.title|safe }}
      </div>

      <!-- Author -->
      <div class="col-lg-2 col-md-3 col-sm-6">
        <h class="display-6" for="author">{% trans "Author" %}</h>
        {{ form.author|safe }}
      </div>

      <!-- Saved By (user) -->
      <div class="col-lg-2 col-md-3 col-sm-6">
        <h class="display-6" for="saved_by">{% trans "Saved by" %}</h>
        {{ form.saved_by|safe }}
      </div>

      <div class="col"></div>
    </div>

    <div class="row">

      <!-- Original text -->
      <div class="col">
        <h class="display-6">
          {% trans "Original Text" %}
        </h>
        {{ form.original_text|safe }}
      </div>

      <!-- Translation text -->
      <div class="col">
        <h class="display-6">
          {% trans "Translation" %}
        </h>
        {{ form.translation|safe }}
      </div>
    </div>
  </form>
</div>
{% endif %}
{% endblock %}