{% extends 'base.html' %}
{% load i18n %}

{% block content %}

<style>
  .row {
    margin-top: 5px;
  }
</style>

{% if poem.is_hidden and not user.username == poem.saved_by %}
<div class="container-fluid text-center">
  <h class="display-6">{% trans 'This poem is hidden by its author' %}</h>
</div>
{% else %}
<div class="container-fluid px-4">
  <form action="{% url 'poem_update' poem.id %}" method="post">
    {% csrf_token %}

    <!-- Hidden input for redirecting to poem_update -->
    <input type="text" hidden value="1" name="edit">

    <!-- Language engine -->
    <div class="row my-3"><h class="display-6">{% trans "Translation Service" %} - <span class="fw-bold">{{ poem.language_engine }}</span></h></div>

    <div class="row" hidden>{{ form.language_engine }}</div>

    <div class="row justify-content-start align-items-center">
    
      <!-- Source language -->
      <div class="col-auto">
        <input hidden type="text" value="{{ form.source_lang.value }}" name="source_lang">
        {{ form.source_lang }}
      </div>
    
      <!-- A simple right arrow -> -->
      <div class="col-auto">
        <i class="fa-solid fa-arrow-right fa-beat fa-xl"></i>
      </div>
      
      <!-- Target language -->
      <div class="col-auto">
        <input hidden type="text" value="{{ form.target_lang.value }}" name="target_lang">
        {{ form.target_lang }}
      </div>
    
      <!-- If user is poem's author, show the Change button -->
      {% if user.username == poem.saved_by %}
      <div class="col-sm-auto">
        <button class="btn btn-primary shadow-none" type="submit">{% trans "Change Poem" %}</button>
      </div>
      {% endif %}
    
    </div>

    <!-- Updated at (hidden) -->
    <div class="col" hidden>{{ form.updated_at }}</div>

    <!-- Title -->
    <div class="row justify-content-start">
      <div class="col-auto">
        <h3 for="title">{% trans "Title" %}</h3>
      </div>
      <div class="col-5">
        {{ form.title|safe }}
      </div>
    </div>

    <!-- Author -->
    <div class="row justify-content-start">
      <div class="col-auto">
        <h3 for="author">{% trans "Author" %}</h3>
      </div>
      <div class="col-5">
        {{ form.author|safe }}
      </div>
    </div>

    <!-- Saved By (user) -->
    <div class="row justify-content-start">
      <div class="col-auto">
        <h3 for="saved_by">{% trans "Saved by" %}</h3>
      </div>
      <div class="col-auto">
        <h3>{{ poem.saved_by }}</h3>
      </div>
    </div>

      <!-- Is hidden from library -->
      <div class="row justify-content-start">
        <div class="col">
          {{ form.is_hidden|safe }}
          <input hidden type="text" value="{{ form.is_hidden.value }}" name="is_hidden">
          <label class="form-check-label" for="flexSwitchCheckDefault">{% trans "Hide from Poem Library" %}</label>
        </div>
      </div>
      

    <div class="row">
      
      <!-- Original text -->
      <div class="col-sm-12 col-md-6">
        <div class="row">
          <h1>
            {% trans "Original Text" %}
          </h1>
        </div>
        <div class="row">
          <div class="copyable-textbox">
            {{ form.original_text|safe }}

            <!-- Copy to clipboard icon -->
            <i id="copy_to_clipboard" class="far fa-copy copy-to-clipboard">
              <i id="check-icon" class="fa-solid fa-check save-check"></i>
            </i>
          </div>
        </div>

      </div>

      <!-- Translation text -->
      <div class="col-sm-12 col-md-6">
        <div class="row">
        <h1>
          {% trans "Translation" %}
        </h1>
      </div>
      <div class="row">
        <div class="copyable-textbox">
          {{ form.translation|safe }}

          <!-- Copy to clipboard icon -->
          <i id="copy_to_clipboard" class="far fa-copy copy-to-clipboard">
            <i id="check-icon" class="fa-solid fa-check save-check"></i>
          </i>
        </div>
      </div>
      </div>
      
    </div>
  </form>
</div>
{% endif %}
{% endblock %}